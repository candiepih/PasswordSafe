(()=>{"use strict";const e={lower:"a-z",upper:"A-Z",number:"0-9",symbol:"!\"\\#\\$%\\&'()\\*\\+,-.\\/:;<=>\\?@\\[\\]\\^_'\\|"},t=()=>{const e=new Uint8Array(1);return window.crypto.getRandomValues(e),e[0]},n=(n,s)=>{const r=(o=Object.keys(n).filter((e=>n[e])).map((t=>e[t])).join(""),new RegExp(`[${o}]`));var o;return Array.from({length:s},(()=>{for(;;){const e=t(),n=String.fromCharCode(e);if(r.test(n))return n}})).join("")};const s=[...document.getElementsByClassName("holder").item(0).children],r=document.querySelector(".generate"),o=document.querySelector(".available"),c=document.querySelector(".first-time"),a=document.querySelector("#send-key"),i=document.querySelector(".default"),l=chrome.runtime.connect({name:"popup"});l.postMessage({action:"checkUser"}),l.onMessage.addListener((e=>{void 0!==e.isNew&&(e.isNew?(c.classList.remove("hide"),a.addEventListener("click",d)):(c.classList.add("hide"),i.classList.remove("hide"),u(e.sites),e.sites.length>0&&p()))}));const d=()=>{const e=document.querySelector('input[type="secret"]'),t=e.value;t?(e.classList.contains("error")&&e.classList.remove("error"),l.postMessage({action:"registerUser",key:t})):e.classList.add("error")},u=e=>{const t=o.querySelector("#cards-container");if(0===e.length)t.innerHTML='<p class="no-sites">You haven\'t saved passwords yet.<br>Save to view them here.</p>';else{const n=e.map((e=>{const t=e.url;return`<div class="item-card">\n            <div class="logo">\n              <h1>${t[0]}</h1>\n            </div>\n            <div class="details">\n              <div class="container">\n                <p class="name">${t}</p>\n                <div class="password-cont">\n                  <p class="password icons">${"&#11044;".repeat(e.passLength)}</p>\n                  <img src="./icons/eye.svg" alt="" height="20px" class="view">\n                  <img src="./icons/copy.svg" alt="" height="20px" class="copy">\n                  <img src="./icons/delete.svg" alt="delete" height="20px" class="delete">\n                </div>\n              </div>\n            </div>\n          </div>`})).join("");t.innerHTML=n}},p=()=>{const e=[...document.querySelectorAll(".view")],t=[...document.querySelectorAll(".copy")],n=[...document.querySelectorAll(".delete")];e.forEach((e=>{e.addEventListener("click",(e=>y(e.target)))})),t.forEach((e=>{e.addEventListener("click",(e=>v(e.target)))})),n.forEach((e=>{e.addEventListener("click",(e=>h(e.target)))}))},m=e=>{return t=void 0,n=void 0,r=function*(){return new Promise(((t,n)=>{const s=chrome.runtime.connect({name:"popup"});s.postMessage({action:"viewPassword",url:e}),s.onMessage.addListener((e=>{void 0===e.password?n(e):t(e),s.disconnect()}))}))},new((s=void 0)||(s=Promise))((function(e,o){function c(e){try{i(r.next(e))}catch(e){o(e)}}function a(e){try{i(r.throw(e))}catch(e){o(e)}}function i(t){var n;t.done?e(t.value):(n=t.value,n instanceof s?n:new s((function(e){e(n)}))).then(c,a)}i((r=r.apply(t,n||[])).next())}));var t,n,s,r},v=e=>{const t=e.parentElement.parentElement.querySelector(".name").innerText;m(t).then((e=>{const t=e.password;navigator.clipboard.writeText(t),setTimeout((()=>{alert("Password copied to clipboard")}),50)})).catch((e=>{console.log(e)}))},y=e=>{const t=e.parentElement.parentElement,n=t.querySelector(".name"),s=t.querySelector(".password"),r=n.innerText;m(r).then((e=>{s.classList.contains("icons")?(s.classList.remove("icons"),s.innerText=e.password):(s.classList.add("icons"),s.innerHTML="&#11044;".repeat(e.passLength))}))},h=e=>{const t=e.parentElement.parentElement.querySelector(".name").innerText;if(confirm(`Are your sure you want to delete password of ${t}?`)){const e=chrome.runtime.connect({name:"popup"});e.postMessage({action:"deletePassword",url:t}),e.onMessage.addListener((t=>{void 0!==t.deleted&&t.deleted&&u(t.sites),e.disconnect()}))}};s.forEach((e=>{e.addEventListener("click",(e=>{var t;(t=e.target).classList.contains("holder")||(t.classList.add("active"),"block"===r.style.display?(r.style.display="none",o.style.display="block"):(r.style.display="block",o.style.display="none"),s.forEach((e=>{e!==t&&e.classList.remove("active")})))}))}));const g=[...document.querySelectorAll('input[type="checkbox"]')],w=document.querySelector("#generate-password"),L=document.querySelector("#password-value"),f=document.querySelector("#password-length"),E=document.querySelector("#password-length-label"),S=document.querySelector("#copy-generated-password");w.addEventListener("click",(()=>b())),f.addEventListener("change",(e=>x(e.target))),S.addEventListener("click",(()=>k()));const q={lower:!0,upper:!0,number:!0,symbol:!0};g.forEach((e=>{e.addEventListener("change",(e=>{const t=e.target;q[t.name]=t.checked,L.innerText=n(q,parseInt(f.value))}))})),L.innerText=n(q,parseInt(f.value));const x=e=>{E.innerText=e.value,L.innerText=n(q,parseInt(e.value))},b=()=>{g.forEach((e=>{q[e.name]=e.checked})),Object.values(q).every((e=>!1===e))?alert("Please select at least one filter"):L.innerText=n(q,parseInt(f.value))},k=()=>{const e=L.innerText;navigator.clipboard.writeText(e),setTimeout((()=>{alert("Password copied to clipboard")}),50)}})();